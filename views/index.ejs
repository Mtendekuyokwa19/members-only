<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>clubhouse</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class=" bg-slate-900  p-4    text-slate-300  ">
    <nav class="flex  list-none gap-2 justify-evenly">
      <section class="w-1/2 flex gap-9 justify-between">
        <li class="text-2xl font-mono"><h1>clubhouseðŸ¤–</h1></li>
        <section class="flex gap-2">
          <% if (locals.user){%>

          <a href="/">   <button class="p-2 border rounded border-1 flex justify-center items-center gap-2">

           <div class="w-6 flex justify-center items-center text-white  h-6 rounded-full bg-orange-500 text-bold"> 
             <p class="capitalize font-bold"><%=user.username.split("")[0]%></p> 
           </div> 
            <p class="capitalize"><%=user.username%></p>
          </button>
          </a>                 

          <% if (locals.user){%>
          <% if (user.member==null){%>

          <a href="/member"><button class="p-2 border rounded border-1">Become a member</button></a>
          <%} %>
          <%} %>
          <a href="/logout"><button class="p-2 border rounded border-1">logout</button></a>

          
          <%} else{%>
          <a href="/signup">   <button class="p-2 border rounded border-1">signup</button>
          </a>                 
          <a href="/login"><button class="p-2 border rounded border-1">login</button></a>

          <%} %>
        </section>
      </section>
    </nav>
  </body>
  <main class="flex justify-center flex-col">
    <section class="flex justify-center p-2 flex-col items-center gap-2 p-4 ">

      <%messages.forEach(message=>{%>


       <div class="w-1/2 border-2 rounded-md p-2"> 
         <div class="flex items-center gap-1 "> 
           <div class="w-12 flex justify-center items-center text-white  h-12 rounded-full bg-orange-500 text-bold"> 
             <p class="capitalize font-bold"><%=message.firstname.split("")[0]%></p> 
           </div> 
           <div> 
            <%if(locals.user){%>
             <p class="text-md capitalize text-emerald-300"><%=message.firstname%></p> 
             <p class="text-sm text-slate-400 ">@<%=message.username%></p> 

            <%} else {%>
             <p class="text-md capitalize text-emerald-300">xxxxx</p> 
             <p class="text-sm text-slate-400 ">xxxxx</p> 
            <%} %>
           </div> 

            <%if(locals.user){%>
            <%if(user.user_type==1){%>
          <div class="w-full text-right"><a href="/delete/<%=message.msgid%>">X</a></div>
            <%} %>
            <%} %>
         </div> 
         <div> 
           <p><%=message.text%></p> 
         </div> 
         <p class="text-sm text-slate-400 text-right "><%=message.date%></p> 
       </div> 

<% })%> 

    </section>
    <section>
     <!-- FIX: sending messages to the backend -->
      
            <%if(locals.user){%>
            <%if(user.member){%>
<form action="/newmessage" class="w-1/2 flex justify-center ">
<input type="text" class="">
        <button>Send</button>
      </form>
      <% }%>
      <% }%>
    </section>
  </main>
</html>
